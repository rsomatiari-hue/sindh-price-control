<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>سندھ سرکاری ریٹ لسٹ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f4f8; margin: 0; display: flex; flex-direction: column; min-height: 100vh; text-align: right; }
        
        /* Official Header */
        .header-bg { background: #1b5e20; color: white; padding: 25px 15px; text-align: center; border-bottom: 4px solid #f1c40f; }
        .main-title { font-size: 16px; font-weight: bold; line-height: 1.4; margin: 0; }
        .director-text { font-size: 14px; margin-top: 5px; font-weight: bold; border-top: 1px solid rgba(255,255,255,0.2); display: inline-block; padding-top: 5px; }

        .controls { background: white; padding: 15px; border-bottom: 1px solid #ddd; position: sticky; top: 0; z-index: 100; }
        .city-select { width: 100%; padding: 12px; border: 2px solid #2e7d32; border-radius: 10px; font-weight: bold; margin-bottom: 10px; }
        
        .cat-container { display: flex; overflow-x: auto; gap: 8px; padding-bottom: 10px; scrollbar-width: none; }
        .cat-btn { background: #f0f4f8; border: 1px solid #2e7d32; color: #2e7d32; padding: 8px 15px; border-radius: 20px; font-size: 13px; font-weight: bold; white-space: nowrap; cursor: pointer; }
        .cat-btn.active { background: #2e7d32; color: white; }

        .price-card { background: white; margin: 10px 15px; padding: 15px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-right: 5px solid #2e7d32; }
        .price-tag { color: #2e7d32; font-weight: bold; font-size: 20px; }

        /* Footer */
        .footer { background: #1b5e20; color: white; padding: 20px 10px; text-align: center; border-top: 3px solid #f1c40f; margin-top: auto; }
    </style>
</head>
<body>
    <div class="header-bg">
        <div class="main-title">MARKET COMMITTEE PRICE CONTROL DAILY RATE UPDATES & ONLINE COMPLAIN DATABASE SYSTEM</div>
        <div style="font-size: 11px; margin-top: 5px;">Under Control</div>
        <div class="director-text">Director General Agriculture Marketing Sindh</div>
    </div>

    <div class="controls">
        <select class="city-select" id="cityChoose" onchange="updateCityData()">
            <option value="Matiari">مٹیاری (Matiari)</option>
            <option value="Kazi Ahmed">قاضی احمد (Kazi Ahmed)</option>
            <option value="Hyderabad">حیدرآباد (Hyderabad)</option>
        </select>
        <div class="cat-container">
            <button class="cat-btn active" onclick="filterCat('all', this)">تمام اشیاء</button>
            <button class="cat-btn" onclick="filterCat('veg', this)">سبزیاں</button>
            <button class="cat-btn" onclick="filterCat('fruit', this)">پھل</button>
        </div>
    </div>

    <div id="capture-area"><div id="publicList"></div></div>

    <footer class="footer">
        <span style="font-weight: bold;">GOVERNMENT OF SINDH</span>
        <div class="footer-bottom" style="font-size: 11px; margin-top: 10px;">© 2026 Price Control System | Sindh</div>
    </footer>

    <script>
        const sheetURL = "https://script.google.com/macros/s/AKfycbyF3H19bi79J8_qv1d5ItMStO_cYI3ehsfuVU72JDRbPJewgSq0qYAmn7lZSD6rVfNhSA/exec";
        let allLiveRates = [];
        let currentCat = 'all';

        async function fetchLiveRates() {
            try {
                const response = await fetch(sheetURL);
                allLiveRates = await response.json();
                updateCityData();
            } catch (e) { console.error(e); }
        }

        function updateCityData() {
            const city = document.getElementById('cityChoose').value;
            let data = allLiveRates.filter(item => item.city === city);
            if(currentCat !== 'all') data = data.filter(item => item.c === currentCat);
            
            const list = document.getElementById('publicList');
            list.innerHTML = data.map(item => `
                <div class="price-card">
                    <span style="font-size:18px; font-weight:bold;">${item.n}</span>
                    <span class="price-tag">Rs. ${item.p}</span>
                </div>`).join('');
        }

        function filterCat(cat, btn) {
            currentCat = cat;
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            updateCityData();
        }

        window.onload = fetchLiveRates;
    </script>
</body>
</html>
