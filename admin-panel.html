<script>
    // 1. Apna Naya Web App URL yahan lazmi paste karein
    const scriptURL = "APNA_NEW_DEPLOYMENT_URL_YAHAN_PASTE_KAREN";

    async function registerOfficer() {
        const name = document.getElementById('newName').value.trim();
        const mobile = document.getElementById('newMobile').value.trim();
        const pass = document.getElementById('newPass').value.trim();
        const market = document.getElementById('newMarket').value.trim();
        const msg = document.getElementById('regMsg');
        const btn = document.getElementById('regBtn');

        if(!name || !mobile || !pass || !market) {
            msg.style.color = "red";
            msg.innerText = "تمام خانے پُر کریں!";
            return;
        }

        msg.style.color = "blue";
        msg.innerText = "ڈیٹا بھیجا جا رہا ہے...";
        btn.disabled = true;

        // Mobile number ke shuru mein ' lagana taake Zero gayab na ho
        const formattedMobile = "'" + mobile;

        // Simple URL parameters ke zariye data bhejna (Sub se asaan aur kamyab tariqa)
        const finalURL = `${scriptURL}?name=${encodeURIComponent(name)}&mobile=${encodeURIComponent(formattedMobile)}&pass=${encodeURIComponent(pass)}&market=${encodeURIComponent(market)}&action=register`;

        try {
            // Hum GET request hi bhej rahe hain kyunke ye zyada stable hai
            const response = await fetch(finalURL);
            const result = await response.json();

            if(result.status === "success") {
                msg.style.color = "green";
                msg.innerText = "آفیسر کامیابی سے ایڈ ہو گیا!";
                // Form clear karein
                document.getElementById('newName').value = "";
                document.getElementById('newMobile').value = "";
                document.getElementById('newPass').value = "";
                document.getElementById('newMarket').value = "";
            } else {
                msg.style.color = "red";
                msg.innerText = "سرور کی طرف سے مسئلہ ہے: " + result.message;
            }
        } catch(e) {
            msg.style.color = "red";
            msg.innerText = "ڈیٹا محفوظ ہو گیا (یا سرور کا مسئلہ ہے)۔ براہ کرم شیٹ چیک کریں۔";
            console.log(e);
        } finally {
            btn.disabled = false;
        }
    }
</script>
