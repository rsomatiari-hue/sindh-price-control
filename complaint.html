<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>موصولہ شکایات - پرائس کنٹرول</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --sindh-green: #1b5e20; --vip-black: #1a1a1a; --vip-golden: #d4af37; }
        body { font-family: 'Segoe UI', sans-serif; background: #f1f8e9; margin: 0; text-align: right; padding-bottom: 80px; }
        
        .header-bg { background: var(--sindh-green); color: white; padding: 15px; text-align: center; border-bottom: 4px solid #f1c40f; }
        
        .container { padding: 15px; }
        .complaint-card { 
            background: white; border-radius: 15px; padding: 15px; margin-bottom: 15px; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); border-right: 5px solid var(--sindh-green);
        }
        .complaint-header { display: flex; justify-content: space-between; border-bottom: 1px solid #eee; padding-bottom: 8px; margin-bottom: 10px; }
        .status-badge { background: #f39c12; color: white; padding: 3px 10px; border-radius: 20px; font-size: 12px; }
        
        .detail-row { margin-bottom: 5px; font-size: 14px; }
        .detail-row strong { color: var(--sindh-green); }

        .btn-call { 
            display: inline-block; background: #27ae60; color: white; 
            padding: 8px 15px; border-radius: 8px; text-decoration: none; margin-top: 10px; font-size: 14px;
        }
        
        #loading { text-align: center; padding: 20px; font-weight: bold; color: var(--sindh-green); }
    </style>
</head>
<body>

    <div class="header-bg">
        <h2 style="margin:0; font-size: 18px;">موصولہ شکایات (Complaints)</h2>
        <div id="officerCity" style="font-size: 13px; color: #f1c40f;">شہر: لوڈ ہو رہا ہے...</div>
    </div>

    <div class="container" id="complaintsContainer">
        <div id="loading"><i class="fas fa-spinner fa-spin"></i> شکایات لوڈ ہو رہی ہیں...</div>
    </div>

    <div style="position: fixed; bottom: 0; left: 0; right: 0; background: #c8e6c9; display: flex; justify-content: space-around; padding: 12px; border-top: 3px solid var(--sindh-green);">
        <a href="officer-dashboard.html" style="color: #2e7d32; text-decoration: none; text-align: center; font-size: 12px; font-weight: bold;"><i class="fas fa-home" style="display: block; font-size: 22px;"></i>ہوم</a>
        <a href="login.html" style="color: #c0392b; text-decoration: none; text-align: center; font-size: 12px; font-weight: bold;"><i class="fas fa-sign-out-alt" style="display: block; font-size: 22px;"></i>لاگ آؤٹ</a>
    </div>

    <script>
        const sheetURL = "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec"; // Apna Script URL yahan dalein
        const officerCity = localStorage.getItem("userMarket");

        document.getElementById('officerCity').innerText = "شہر: " + officerCity;

        async function fetchComplaints() {
            try {
                const response = await fetch(`${sheetURL}?action=getComplaints&city=${officerCity}`);
                const data = await response.json();
                
                const container = document.getElementById('complaintsContainer');
                container.innerHTML = "";

                if (data.length === 0) {
                    container.innerHTML = "<p style='text-align:center;'>کوئی شکایت موصول نہیں ہوئی۔</p>";
                    return;
                }

                data.forEach(c => {
                    const card = `
                        <div class="complaint-card">
                            <div class="complaint-header">
                                <strong>${c.name}</strong>
                                <span class="status-badge">${c.status}</span>
                            </div>
                            <div class="detail-row"><strong>دکان:</strong> ${c.shop}</div>
                            <div class="detail-row"><strong>تفصیل:</strong> ${c.detail}</div>
                            <div class="detail-row"><strong>تاریخ:</strong> ${c.date}</div>
                            <a href="tel:${c.phone}" class="btn-call"><i class="fas fa-phone"></i> رابطہ کریں</a>
                        </div>
                    `;
                    container.innerHTML += card;
                });
            } catch (error) {
                document.getElementById('complaintsContainer').innerHTML = "ڈیٹا لوڈ کرنے میں مسئلہ ہے۔";
            }
        }

        window.onload = fetchComplaints;
    </script>
</body>
</html>
