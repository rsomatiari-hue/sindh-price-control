<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sindh Price Control | Official Login</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu&family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1b5e20; --accent: #2e7d32; --bg: #f8faf8; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg); height: 100vh; margin: 0; display: flex; justify-content: center; align-items: center; position: relative; }
        
        /* Glassmorphism Card */
        .login-card { background: white; padding: 35px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 90%; max-width: 380px; text-align: center; border-top: 8px solid var(--primary); }
        
        .logo { width: 70px; margin-bottom: 10px; }
        h2 { color: var(--primary); margin: 10px 0; font-family: 'Noto Nastaliq Urdu', serif; font-size: 24px; }
        
        .input-group { margin-bottom: 15px; text-align: right; }
        label { display: block; margin-bottom: 5px; color: #444; font-weight: 500; font-size: 14px; }
        input { width: 100%; padding: 12px; border: 1.5px solid #ddd; border-radius: 10px; font-size: 16px; box-sizing: border-box; }
        input:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 8px rgba(27,94,32,0.1); }

        .login-btn { width: 100%; padding: 14px; background: var(--primary); color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        .login-btn:hover { background: var(--accent); }

        /* VIP BACK TO HOME BUTTON */
        .back-home { display: inline-block; margin-top: 20px; color: var(--primary); text-decoration: none; font-size: 14px; font-weight: 500; transition: 0.3s; }
        .back-home:hover { color: #000; text-decoration: underline; }
        
        #msg { margin-top: 15px; font-size: 14px; color: #d32f2f; display: none; }
    </style>
</head>
<body>

<div class="login-card">
    <img src="https://upload.wikimedia.org/wikipedia/commons/b/ba/Government_of_Sindh_Logo.png" alt="Sindh Logo" class="logo">
    <h2>آفیسر لاگ ان</h2>
    <p style="color:#666; font-size:12px; margin-bottom:20px;">Sindh Essential Commodities Price Control</p>

    <div class="input-group">
        <label>موبائل نمبر (Mobile)</label>
        <input type="number" id="mobile" placeholder="03XXXXXXXXX">
    </div>

    <div class="input-group">
        <label>پاس ورڈ (Password)</label>
        <input type="password" id="pass" placeholder="••••••••">
    </div>

    <button onclick="performLogin()" id="btn" class="login-btn">لاگ ان کریں</button>
    
    <div id="msg"></div>

    <a href="index.html" class="back-home">← واپس ہوم پیج پر جائیں</a>
</div>

<script>
    // FINAL SCRIPT URL (Aapka V14 URL)
    const apiURL = "https://script.google.com/macros/s/AKfycbyF3H19bi79J8_qv1d5ItMStO_cYI3ehsfuVU72JDRbPJewgSq0qYAmn7lZSD6rVfNhSA/exec";

    function performLogin() {
        const m = document.getElementById('mobile').value;
        const p = document.getElementById('pass').value;
        const b = document.getElementById('btn');
        const msg = document.getElementById('msg');

        if(!m || !p) { alert("Details enter karein!"); return; }

        b.innerText = "رابطہ ہو رہا ہے...";
        b.disabled = true;

        const script = document.createElement('script');
        script.src = `${apiURL}?action=login&mobile=${m}&pass=${p}&callback=onLoginResponse&ts=${new Date().getTime()}`;
        document.body.appendChild(script);
    }

    window.onLoginResponse = function(res) {
        const b = document.getElementById('btn');
        const msg = document.getElementById('msg');

        if(res.status === "success") {
            localStorage.setItem("userRole", res.role);
            localStorage.setItem("userCity", res.city);
            
            const role = res.role.toLowerCase().trim();
            
            // REDIRECTION LOGIC
            if(role === "admin") {
                window.location.href = "admin-panel.html";
            } else if(role === "ac") {
                window.location.href = "ac-monitoring.html";
            } else if(role === "dg") {
                window.location.href = "dg-monitoring.html";
            } else {
                window.location.href = "officer-dashboard.html";
            }
        } else {
            msg.innerText = "لاگ ان ناکام! معلومات درست نہیں۔";
            msg.style.display = "block";
            b.innerText = "لاگ ان کریں";
            b.disabled = false;
        }
    }
</script>

</body>
</html>
